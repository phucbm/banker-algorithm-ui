(()=>{"use strict";var e={988:(e,t,a)=>{var l=a(963),o=a(252),s=a(577);const n=(0,o.Uk)("Banker Algorithm UI"),i=(0,o.Uk)(" Xử lý input "),u=(0,o.Uk)(" Xoá input "),r=(0,o._)("h2",null,"Nhập số lượng tiến trình và tài nguyên:",-1),c=(0,o.Uk)(" Cập nhật "),d=(0,o._)("h2",null,"Input",-1),h=(0,o._)("h3",null,"MAX",-1),p=["value"],m=(0,o._)("h3",null,"Allocation",-1),g=["value"],f=(0,o._)("h3",null,"Need",-1),w=(0,o._)("h3",null,"Work (Available)",-1),v=["value"],y=(0,o._)("h3",null,"Yêu cầu tài nguyên",-1),b=["value"],_=(0,o.Uk)(" Thực hiện yêu cầu "),k=(0,o.Uk)("Hệ thống không an toàn."),D=(0,o.Uk)("Hệ thống an toàn."),x=(0,o.Uk)(" Minh hoạ cuối kỳ môn Hệ Điều Hành 2022 - Giảng viên Trần Đức Tâm ");function C(e,t,a,l,C,W){const S=(0,o.up)("v-app-bar-title"),q=(0,o.up)("v-btn"),A=(0,o.up)("v-btn-group"),j=(0,o.up)("v-app-bar"),O=(0,o.up)("v-col"),H=(0,o.up)("v-text-field"),T=(0,o.up)("v-row"),V=(0,o.up)("v-form"),L=(0,o.up)("v-table"),N=(0,o.up)("v-radio"),P=(0,o.up)("v-radio-group"),Y=(0,o.up)("v-alert"),I=(0,o.up)("v-container"),R=(0,o.up)("v-main"),$=(0,o.up)("v-footer"),K=(0,o.up)("v-app");return(0,o.wg)(),(0,o.j4)(K,null,{default:(0,o.w5)((()=>[(0,o.Wm)(j,{app:""},{default:(0,o.w5)((()=>[(0,o.Wm)(S,null,{default:(0,o.w5)((()=>[n])),_:1}),(0,o.Wm)(A,{divided:""},{default:(0,o.w5)((()=>[(0,o.Wm)(q,{color:"primary",variant:"outlined",onClick:W.checkSystem},{default:(0,o.w5)((()=>[i])),_:1},8,["onClick"]),(0,o.Wm)(q,{color:"red",variant:"outlined",onClick:W.deleteLocalStorage},{default:(0,o.w5)((()=>[u])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.Wm)(R,null,{default:(0,o.w5)((()=>[(0,o.Wm)(I,null,{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[(0,o.Wm)(O,{cols:"12"},{default:(0,o.w5)((()=>[r])),_:1}),(0,o.Wm)(O,{cols:"12"},{default:(0,o.w5)((()=>[(0,o.Wm)(V,{modelValue:C.valid,"onUpdate:modelValue":t[3]||(t[3]=e=>C.valid=e)},{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[(0,o.Wm)(O,{cols:"12",md:"3"},{default:(0,o.w5)((()=>[(0,o.Wm)(H,{modelValue:C.processCount,"onUpdate:modelValue":t[0]||(t[0]=e=>C.processCount=e),rules:C.processCountRules,counter:1,label:"Tiến trình",required:"",Min:"0"},null,8,["modelValue","rules"])])),_:1}),(0,o.Wm)(O,{cols:"12",md:"3"},{default:(0,o.w5)((()=>[(0,o.Wm)(H,{modelValue:C.resourceCount,"onUpdate:modelValue":t[1]||(t[1]=e=>C.resourceCount=e),rules:C.resourceCountRules,counter:1,label:"Tài nguyên",required:"",Min:"0"},null,8,["modelValue","rules"])])),_:1}),(0,o.Wm)(O,{cols:"12",md:"3"},{default:(0,o.w5)((()=>[(0,o.Wm)(q,{color:"green",variant:"outlined",onClick:t[2]||(t[2]=e=>W.updateTables(!0)),height:"55"},{default:(0,o.w5)((()=>[c])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[(0,o.Wm)(O,{cols:"12"},{default:(0,o.w5)((()=>[d])),_:1}),(0,o.Wm)(O,{cols:"12",md:"3"},{default:(0,o.w5)((()=>[h,(0,o.Wm)(L,null,{default:(0,o.w5)((()=>[(0,o._)("thead",null,[(0,o._)("tr",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.max[0],((e,t)=>((0,o.wg)(),(0,o.iD)("th",{class:"text-left",key:t}," R"+(0,s.zw)(t+1),1)))),128))])]),(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.max,((e,a)=>((0,o.wg)(),(0,o.iD)("tr",{"data-max-process":"",key:a},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,a)=>((0,o.wg)(),(0,o.iD)("td",{key:a},[(0,o._)("input",{"data-max-resource":"",value:e,style:{width:"35px"},onChange:t[4]||(t[4]=(...e)=>W.updateData&&W.updateData(...e))},null,40,p)])))),128))])))),128))])])),_:1})])),_:1}),(0,o.Wm)(O,{cols:"12",md:"3"},{default:(0,o.w5)((()=>[m,(0,o.Wm)(L,null,{default:(0,o.w5)((()=>[(0,o._)("thead",null,[(0,o._)("tr",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.allocation[0],((e,t)=>((0,o.wg)(),(0,o.iD)("th",{class:"text-left",key:t}," R"+(0,s.zw)(t+1),1)))),128))])]),(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.allocation,((e,a)=>((0,o.wg)(),(0,o.iD)("tr",{"data-allocation-process":"",key:a},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,a)=>((0,o.wg)(),(0,o.iD)("td",{key:a},[(0,o._)("input",{"data-allocation-resource":"",value:e,style:{width:"35px"},onChange:t[5]||(t[5]=(...e)=>W.updateData&&W.updateData(...e))},null,40,g)])))),128))])))),128))])])),_:1})])),_:1}),C.showNeed?((0,o.wg)(),(0,o.j4)(O,{key:0,cols:"12",md:"3"},{default:(0,o.w5)((()=>[f,(0,o.Wm)(L,null,{default:(0,o.w5)((()=>[(0,o._)("thead",null,[(0,o._)("tr",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.need[0],((e,t)=>((0,o.wg)(),(0,o.iD)("th",{class:"text-left",key:t}," R"+(0,s.zw)(t+1),1)))),128))])]),(0,o._)("tbody",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.need,((e,t)=>((0,o.wg)(),(0,o.iD)("tr",{key:t},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,t)=>((0,o.wg)(),(0,o.iD)("td",{key:t},[(0,o._)("div",null,(0,s.zw)(e),1)])))),128))])))),128))])])),_:1})])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(O,{cols:"12",md:"3"},{default:(0,o.w5)((()=>[w,(0,o.Wm)(L,null,{default:(0,o.w5)((()=>[(0,o._)("thead",null,[(0,o._)("tr",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.allocation[0],((e,t)=>((0,o.wg)(),(0,o.iD)("th",{class:"text-left",key:t}," R"+(0,s.zw)(t+1),1)))),128))])]),(0,o._)("tbody",null,[(0,o._)("tr",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.available,((e,a)=>((0,o.wg)(),(0,o.iD)("td",{key:a},[(0,o._)("input",{"data-available":"",value:e,style:{width:"35px"},onChange:t[6]||(t[6]=(...e)=>W.updateData&&W.updateData(...e))},null,40,v)])))),128))])])])),_:1})])),_:1})])),_:1}),C.showRequest?((0,o.wg)(),(0,o.j4)(T,{key:0},{default:(0,o.w5)((()=>[(0,o.Wm)(O,{cols:"12",md:"4"},{default:(0,o.w5)((()=>[y,(0,o.Wm)(P,{inline:"",modelValue:C.requestProcessIndex,"onUpdate:modelValue":t[7]||(t[7]=e=>C.requestProcessIndex=e)},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.allocation,((e,t)=>((0,o.wg)(),(0,o.j4)(N,{key:t,label:`P${parseInt(t)+1}`,value:t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,o.Wm)(O,{cols:"12",md:"4"},{default:(0,o.w5)((()=>[(0,o.Wm)(L,null,{default:(0,o.w5)((()=>[(0,o._)("thead",null,[(0,o._)("tr",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.allocation[0],((e,t)=>((0,o.wg)(),(0,o.iD)("th",{class:"text-left",key:t}," R"+(0,s.zw)(t+1),1)))),128))])]),(0,o._)("tbody",null,[(0,o._)("tr",null,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.data.available,((e,a)=>((0,o.wg)(),(0,o.iD)("td",{key:a},[(0,o._)("input",{"data-request":"",value:e,style:{width:"35px"},onChange:t[8]||(t[8]=(...e)=>W.updateData&&W.updateData(...e))},null,40,b)])))),128))])])])),_:1}),(0,o.Wm)(q,{color:"blue",variant:"outlined",onClick:W.request},{default:(0,o.w5)((()=>[_])),_:1},8,["onClick"])])),_:1})])),_:1})):(0,o.kq)("",!0),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.logs,((e,t)=>((0,o.wg)(),(0,o.j4)(T,{key:t},{default:(0,o.w5)((()=>[(0,o.Wm)(O,null,{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{variant:"outlined",density:"compact",color:"warning"===e.type?"red":""},{default:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(e.string),1)])),_:2},1032,["color"])])),_:2},1024)])),_:2},1024)))),128)),C.showNeed&&!C.isSystemSafe?((0,o.wg)(),(0,o.j4)(T,{key:1},{default:(0,o.w5)((()=>[(0,o.Wm)(O,null,{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{type:"warning"},{default:(0,o.w5)((()=>[k])),_:1})])),_:1})])),_:1})):(0,o.kq)("",!0),C.showNeed&&C.isSystemSafe?((0,o.wg)(),(0,o.j4)(T,{key:2},{default:(0,o.w5)((()=>[(0,o.Wm)(O,null,{default:(0,o.w5)((()=>[(0,o.Wm)(Y,{type:"success"},{default:(0,o.w5)((()=>[D])),_:1})])),_:1})])),_:1})):(0,o.kq)("",!0)])),_:1})])),_:1}),(0,o.Wm)($,{app:""},{default:(0,o.w5)((()=>[x])),_:1})])),_:1})}class W{constructor(e){this.logPermission={calc:!0,result:!0,process:!0},this.allocation=e.allocation||[],this.max=e.max||[],this.available=e.available||[],this.processCount=this.allocation.length,this.resourceCount=this.allocation[0].length,this.need=this.computeNeedMatrix(),this.logs=[],this.printInput()}log(e,t,a){switch(e){case"process":this.logPermission.process&&console.log(a);break;case"result":this.logPermission.result&&console.log(a);break;case"calc":this.logPermission.calc&&console.log(a);break}this.logs.push({category:e,type:t,string:a})}request(e,t){const a=[...this.available],l=this.need[e];if(this.log("process","info",`P${e+1} requests [${t.join(",")}]`),!this.isVectorALessThanOrEqualToB(t,l))return this.log("result","error",`Request rejected! [${t.join(",")}] asks more than it needs [${l.join(",")}]`),!1;if(!this.isVectorALessThanOrEqualToB(t,a))return this.log("result","warning","Request ON HOLD due to system is not available."),!1;const o=this.minusVector(a,t),s=[...this.allocation];s[e]=this.sumVector(s[e],t);const n=[...this.need];n[e]=this.minusVector(n[e],t);const i=this.isSystemSafe({available:o,allocation:s,need:n});if(!i)return this.log("result","warning","Request ON HOLD due to system unsafe."),!1;this.log("result","success","Request is being processed...")}isSystemSafe({available:e=[...this.available],allocation:t=[...this.allocation],need:a=[...this.need]}={}){const l=[];e.forEach(((e,t)=>l[t]=!1));const o=()=>l.filter((e=>!0===e)).length===l.length;let s=0,n=Math.pow(this.processCount*this.resourceCount,2),i=!1;do{s++;let o=0;for(let s=0;s<e.length;s++){const n=this.isVectorALessThanOrEqualToB(a[s],e);if(this.log("calc",n?"info":"warning",`P${s+1}: So sánh Need [${a[s].join(",")}] <= Available: [${e.join(",")}]? => ${n}`),!l[s]&&n){const a=this.sumVector(e,t[s]);this.log("calc","info",`P${s+1}: Cập nhật Available += Allocation => [${e.join(",")}] + [${t[s].join(",")}] = [${a.join(",")}]`),e=a,l[s]=!0;break}o++}if(o===l.length){console.log("Unsafe detected"),i=!0;break}if(s>n){console.log("Timeout");break}}while(!o()&&!i);return this.log("result","info","Hệ thống an toàn? => "+(o()?"Yes":"No")),o()}minusVector(e,t){const a=[];for(let l=0;l<e.length;l++)a.push(e[l]-t[l]);return this.log("calc","info",`[${e.join(",")}] - [${t.join(",")}] = [${a.join(",")}]`),a}sumVector(e,t){const a=[];for(let l=0;l<e.length;l++)a.push(e[l]+t[l]);return a}isVectorALessThanOrEqualToB(e,t){let a=!0;for(let l=0;l<e.length;l++)if(e[l]>t[l]){a=!1;break}return a}computeNeedMatrix(){const e=[];for(let t=0;t<this.processCount;t++){const a=[];for(let e=0;e<this.resourceCount;e++){const l=this.max[t][e],o=this.allocation[t][e];a.push(l-o)}e.push(a)}return e}printInput(){this.logPermission.result&&(console.log("---\x3e Allocation"),console.table(this.allocation),console.log("---\x3e Max"),console.table(this.max),console.log("---\x3e Need"),console.table(this.need),console.log("---\x3e Available"),console.table(this.available))}}const S={name:"App",data(){return{valid:!1,processCount:2,processCountRules:[e=>e>=2||"Nhập ít nhất 2 tiến trình."],resourceCount:3,resourceCountRules:[e=>e>=2||"Nhập ít nhất 2 tài nguyên."],showNeed:!1,hasLocalData:!1,data:{max:[],allocation:[],available:[]},isSystemSafe:!1,logs:[],showRequest:!1,requestProcessIndex:0}},methods:{deleteLocalStorage(){localStorage.removeItem("banker-algorithm-ui")},loadLocalData(){const e=JSON.parse(localStorage.getItem("banker-algorithm-ui"));e&&(e.processCount&&(this.processCount=e.processCount),e.resourceCount&&(this.resourceCount=e.resourceCount),e.data&&(e.data.max&&(this.data.max=this.parseArray(e.data.max)),e.data.allocation&&(this.data.allocation=this.parseArray(e.data.allocation)),e.data.available&&(this.data.available=this.parseArray(e.data.available)),this.hasLocalData=!0))},saveLocalData(){const e={processCount:this.processCount,resourceCount:this.resourceCount,data:this.data};localStorage.setItem("banker-algorithm-ui",JSON.stringify(e))},updateData(){const e=[];document.querySelectorAll("[data-max-process]").forEach((t=>{const a=[];t.querySelectorAll("[data-max-resource]").forEach((e=>{a.push(parseInt(e.value))})),e.push(a)})),this.data.max={...e};const t=[];document.querySelectorAll("[data-allocation-process]").forEach((e=>{const a=[];e.querySelectorAll("[data-allocation-resource]").forEach((e=>{a.push(parseInt(e.value))})),t.push(a)})),this.data.allocation={...t};const a=[];document.querySelectorAll("[data-available]").forEach((e=>{a.push(parseInt(e.value))})),this.data.available=[...a],this.saveLocalData()},updateTables(e=!1){if(console.log("reset",e),e){const e=[];for(let t=0;t<this.processCount;t++){const t=[];for(let e=0;e<this.resourceCount;e++)t.push(0);e.push(t)}this.data.max=[...e],this.data.allocation=[...e]}else{const e=[],t=[];for(let a=0;a<this.processCount;a++){const l=[],o=[];for(let e=0;e<this.resourceCount;e++){const t=this.hasLocalData?this.data.max[a][e]:0,s=this.hasLocalData?this.data.allocation[a][e]:0;o.push(t),l.push(s)}e.push(l),t.push(o)}this.data.max=[...t],this.data.allocation=[...e]}const t=[];for(let a=0;a<this.resourceCount;a++)t.push(this.hasLocalData?this.data.available[a]:0);this.data.available=[...t],this.saveLocalData()},parseArray(e){const t=[];for(const[a,l]of Object.entries(e))"object"===typeof l?t.push(this.parseArray(l)):t.push(l);return t},checkSystem(){const e={allocation:this.parseArray(this.data.allocation),max:this.parseArray(this.data.max),available:this.parseArray(this.data.available)},t=new W(e),a=t.need;a&&(this.showNeed=!0,this.data.need=[...a]),this.isSystemSafe=t.isSystemSafe(),this.logs=t.logs,console.log("logs",t.logs)},request(){const e=[];if(document.querySelectorAll("[data-request]").forEach((t=>{e.push(parseInt(t.value))})),!e)return;const t={allocation:this.parseArray(this.data.allocation),max:this.parseArray(this.data.max),available:this.parseArray(this.data.available)},a=new W(t);a.request(this.requestProcessIndex,e)}},mounted(){this.loadLocalData(),this.updateTables()}};var q=a(744);const A=(0,q.Z)(S,[["render",C]]),j=A;a(773);var O=a(626),H=a(300),T=a(291);const V=(0,T.Rd)({components:O,directives:H,theme:{defaultTheme:"light"}});(0,l.ri)(j).use(V).mount("#app")}},t={};function a(l){var o=t[l];if(void 0!==o)return o.exports;var s=t[l]={exports:{}};return e[l](s,s.exports,a),s.exports}a.m=e,(()=>{var e=[];a.O=(t,l,o,s)=>{if(!l){var n=1/0;for(c=0;c<e.length;c++){for(var[l,o,s]=e[c],i=!0,u=0;u<l.length;u++)(!1&s||n>=s)&&Object.keys(a.O).every((e=>a.O[e](l[u])))?l.splice(u--,1):(i=!1,s<n&&(n=s));if(i){e.splice(c--,1);var r=o();void 0!==r&&(t=r)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[l,o,s]}})(),(()=>{a.d=(e,t)=>{for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}})(),(()=>{a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={143:0};a.O.j=t=>0===e[t];var t=(t,l)=>{var o,s,[n,i,u]=l,r=0;if(n.some((t=>0!==e[t]))){for(o in i)a.o(i,o)&&(a.m[o]=i[o]);if(u)var c=u(a)}for(t&&t(l);r<n.length;r++)s=n[r],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(c)},l=self["webpackChunkbanker_algorithm_ui"]=self["webpackChunkbanker_algorithm_ui"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var l=a.O(void 0,[998],(()=>a(988)));l=a.O(l)})();
//# sourceMappingURL=app.bd8000e9.js.map